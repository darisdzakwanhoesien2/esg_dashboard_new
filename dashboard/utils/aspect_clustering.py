ASPECT_CLUSTER_JSON = {

    # =========================
    # GOVERNANCE
    # =========================
    "Governance & Board": [
        "governance", "board", "board of directors", "board of commissioners",
        "board composition", "board independence", "board diversity",
        "leadership", "executive", "committee", "oversight",
        "corporate governance", "management oversight",
        "governance", "board", "board composition", "board structure",
        "shareholder", "shareholding", "shareholder structure",
        "corporate actions", "ipo", "listing",
        "general meeting", "share ownership",
        "corporate structure", "organization structure",
        "subsidiaries", "related parties", "related party transactions",
        "remuneration", "remuneration policy",
        "voter participation", "succession planning",
        "company", "company name", "affiliation",
        "stakeholder engagement",
        "Stakeholders",
        "Good Corporate Governance implementation",
        "ultimate beneficial ownership",
        "Board of Directors performance",
        "nomination and selection process compliance",
        "succession program",
        "stakeholder communication",
        "stakeholder relations",
        "corporate governance",
        "organizational hierarchy",
        "stakeholder feedback",
        "stakeholder identification",
        "successor development",
        "ultimate beneficial ownership"

    ],

    "Risk Management & Internal Control": [
        "risk", "risk management", "risk assessment", "risk mitigation",
        "internal control", "internal audit", "control system",
        "compliance risk", "legal risk", "liquidity risk", "credit risk"
    ],

    "Ethics, Integrity & Anti-Corruption": [
        "ethics", "integrity", "anti-corruption", "anti bribery",
        "whistleblowing", "conflict of interest", "fraud",
        "business ethics", "transparency", "code of conduct"
    ],

    # =========================
    # ENVIRONMENT
    # =========================
    "Emissions & Climate": [
        "emission", "carbon", "ghg", "greenhouse gas",
        "scope 1", "scope 2", "scope 3",
        "climate change", "net zero", "decarbonization",
        "methane", "flaring"
    ],

    "Energy": [
        "energy", "renewable", "energy efficiency",
        "biofuel", "hydrogen", "electricity",
        "clean fuel", "energy transition"
    ],

    "Water & Waste": [
        "water", "water consumption", "water withdrawal",
        "water recycling", "waste", "waste management",
        "hazardous waste", "waste reduction", "recycling",
        "spill incidents",
        "oil spill incidents",
        "water management",
        "waste management",
        "water consumption",
        "water recycling",
        "hazardous waste management",
        "water discharge",
        "clean water access",
        "wastewater discharge",
        "circular economy",
        "produced water",
        "oil spill management",
        "oil spill prevention",
        "effluent management",
        "effluent reduction",
        "water withdrawal",
        "produced water handling and reinjection",
        "waste reduction via 3R",
        "hazardous waste generation",
        "water use reduction",
        "wastewater treatment",
        "hazardous waste recycling"

    ],

    "Biodiversity & Environmental Impact": [
        "biodiversity", "ecosystem", "environmental impact",
        "environmental footprint", "conservation",
        "rehabilitation", "land use", "habitat", " Environment", "E",
            "wildlife release",
            "tree planting and forest restoration",
            "buffer zone expansion and compliance",
            "HCV assessments (High Conservation Value)",
            "forest management and restoration",
            "mangrove planting impact",
            "coral reef restoration and turtle release",
            "protected species impact and count",
            "nature-based solutions (NBS)",
            "environmental protection and reclamation",
            "reserves in protected or conflict areas",
            "whale shark population count"
    ],

    # =========================
    # SOCIAL
    # =========================
    "Human Capital & Workforce": [
        "employees", "workforce", "human capital",
        "training", "education", "talent", "skills",
        "employee development", "employee engagement"
    ],

    "Health, Safety & Well-being": [
        "health", "safety", "occupational health",
        "workplace safety", "accident", "injury",
        "ohs", "hsse", "well-being"
    ],

    "Diversity, Equity & Inclusion": [
        "diversity", "inclusion", "gender",
        "equal opportunity", "gender equality",
        "pay equity", "women", "minority"
    ],

    "Human Rights & Labor Practices": [
        "human rights", "child labor", "forced labor",
        "labor practices", "freedom of association",
        "fair labor", "worker rights"
    ],

    "Community & Social Impact": [
        "community", "csr", "social responsibility",
        "social impact", "education", "healthcare",
        "local community", "public health","social performance","Social"
    ],

    # =========================
    # VALUE CHAIN
    # =========================
    "Supply Chain & Procurement": [
        "supply chain", "supplier", "procurement",
        "sourcing", "traceability",
        "supplier sustainability", "local supplier"
    ],

    "Customers & Product Responsibility": [
        "customer", "customer satisfaction",
        "product safety", "product quality",
        "service quality", "consumer protection"
    ],


    # =========================
    # STRATEGY & REPORTING
    # =========================
    "Sustainability Strategy & ESG": [
        "sustainability", "esg", "sustainability strategy",
        "sustainable development", "sdgs",
        "sustainability roadmap", "sustainability policy",
            "sustainable finance",
        "SDG alignment",
        "ESG performance",
        "sustainable bond issuance",
        "Material Topic Management",
        "sustainable business practices",
        "sustainable building practices",
        "sustainable finance performance",
        "sustainable research center",
        "SDG contribution",
        "PROPER Emas certification"
    ],

    "Reporting, Disclosure & Assurance": [
        "reporting", "disclosure", "sustainability report",
        "assurance", "verification", "audit opinion",
        "report quality", "materiality"
    ],

    # =========================
    # FINANCIAL & BUSINESS
    # =========================
    "Financial Performance & Capital": [
        "revenue", "profit", "profitability",
        "capital", "assets", "liabilities",
        "cash flow", "equity", "investment", "financial","financial performance",'financial instruments',"economic performance"
    ],

    "Business Strategy & Operations": [
        "operations", "business strategy",
        "growth", "innovation", "digital transformation",
        "operational efficiency", "infrastructure",
        "corporate strategy and strategic direction",
        "business expansion and international expansion",
        "operational disruption and impact management",
        "business model and business diversification",
        "strategic partnerships and collaboration",
        "asset management and identification",
        "market share and market presence",
        "brand transformation and rebranding",
        "operational effectiveness and efficiency",
        "product development and launch"
    ],

    # =========================
    # DIGITAL & DATA
    # =========================
    "Digital & Data Security": [
        "digital", "cyber", "data security",
        "information security", "it", "technology",
        "privacy", "digital transformation"
    ]
}


# ASPECT_CLUSTER_JSON = {
#     "Governance": [
#         "governance",
#         "corporate governance",
#         "board oversight",
#         "management oversight"
#     ],
#     "Emissions": [
#         "emissions",
#         "carbon",
#         "carbon footprint",
#         "ghg",
#         "greenhouse gas",
#         "scope 1",
#         "scope 2",
#         "scope 3"
#     ],
#     "Financial Reporting": [
#         "financial reporting",
#         "financial performance",
#         "financial disclosure",
#         "financial"
#     ],
#     "Climate & Energy": [
#         "energy",
#         "renewable energy",
#         "energy efficiency",
#         "energy transition"
#     ],
#     "Community & Social Impact": [
#         "stakeholder engagement",
#         "community",
#         "social impact"
#     ],
#     "Tax & Compliance": [
#         "tax",
#         "taxation",
#         "compliance"
#     ]
# }

def cluster_aspect(aspect: str) -> str:
    if not isinstance(aspect, str):
        return "Unclustered"

    a = aspect.lower()
    for cluster, keywords in ASPECT_CLUSTER_JSON.items():
        for kw in keywords:
            if kw in a:
                return cluster
    return "Unclustered"
